<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin ‚Äì Quiz o nas ‚ù§Ô∏è</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { background:#111; color:#fff; font-family:Segoe UI,sans-serif; padding:30px; }
    .container { max-width:800px; margin:0 auto; background:rgba(255,255,255,0.08); padding:40px; border-radius:16px; }
    h1 { color:#ff4081; text-align:center; margin-bottom:30px; }
    h3 { color:#ff6f91; margin:40px 0 15px; }
    .choice { background:rgba(255,255,255,0.05); padding:16px; margin:12px 0; border-radius:12px; border-left:5px solid #ff4081; }
    .choice strong { color:#ffb3c6; }
    button { padding:12px 24px; font-size:1.1rem; margin:8px; border:none; border-radius:8px; cursor:pointer; }
    #addBtn { background:#4caf50; color:white; }
    #resetBtn { background:#f44336; color:white; }
  </style>
</head>
<body>

<div class="container">
  <h1>Panel administracyjny ‚Äì Klaudiusz ‚ù§Ô∏è</h1>

  <p style="text-align:center; font-size:1.4rem;">
    Aktualne punkty: <strong id="adminTotal">0</strong>
  </p>

  <div style="text-align:center; margin:30px 0;">
    <input type="number" id="pointsInput" placeholder="Dodaj / odejmij" style="padding:12px; font-size:1.3rem; width:160px; text-align:center;">
    <button id="addBtn" onclick="changePoints()">Zastosuj</button>
  </div>

  <div style="text-align:center; margin:30px 0;">
    <button id="resetBtn" onclick="setPoints(0)">Resetuj do 0</button>
    <button onclick="setPoints(5)">Ustaw 5</button>
    <button onclick="setPoints(10)">Ustaw 10</button>
    <button onclick="setPoints(15)">Ustaw 15</button>
    <button onclick="setPoints(20)">Ustaw 20</button>
    <button onclick="setPoints(35)">Ustaw 35</button>
  </div>

  <!-- NEW: Would You Rather Choices -->
  <div id="wyrChoicesSection" style="margin-top:60px;">
    <h3>Jej wybory w Would You Rather</h3>
    <div id="choicesList" style="font-size:1.2rem;"></div>
    <button onclick="clearWyrChoices()" style="margin-top:20px; padding:10px 20px; background:#f44336; color:white; border:none; border-radius:8px; cursor:pointer;">
      Wyczy≈õƒá historiƒô wybor√≥w
    </button>
  </div>

  <!-- QUIZ QUESTIONS OVERVIEW -->
<div id="quizQuestionsSection" style="margin-top:60px;">
  <h3>Wszystkie pytania quizu</h3>

  <div id="quizQuestionsList" style="font-size:1.15rem;"></div>

  <div style="margin-top:20px; font-size:0.95rem; color:#aaa;">
    <p>üí° R√≥≈ºowe ‚Äì pytania wbudowane</p>
    <p>üíö Zielone ‚Äì pytania dodane przez niƒÖ</p>
  </div>
</div>


  <div style="text-align:center; margin-top:80px;">
    <button onclick="window.close()" style="padding:12px 30px; background:#ff4081; color:white; border:none; border-radius:12px; font-size:1.2rem; cursor:pointer;">
      Zamknij okno
    </button>
  </div>
</div>

<script type="module">
  
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getFirestore, collection, onSnapshot, deleteDoc, doc } 
    from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBf7tYEGzG112MQ2xKmzKJv9SAZbH6Y7so",
    authDomain: "quiz-o-nas.firebaseapp.com",
    projectId: "quiz-o-nas",
    storageBucket: "quiz-o-nas.appspot.com",
    messagingSenderId: "467382949049",
    appId: "1:467382949049:web:bb92db1e925cebec257768"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  onSnapshot(collection(db, "questions"), snapshot => {
    console.log("LIVE QUESTIONS:", snapshot.docs.length);
    // TU zaraz wstawimy renderowanie
  });


  const ADMIN_PASSWORD = "Klaudiusz+Marysia";

  // ===== PYTANIA WBUdOWANE (MUSI BYƒÜ TO SAMO CO W script.js) =====
 const ALL_QUESTIONS = [
    { q: "Kiedy siƒô poznali≈õmy?", answers: ["14 lutego", "1 marca", "28 stycznia", "18 sierpnia"], correct: 2 },
    { q: "Jakim pieszczotliwym imieniem mnie nazywa≈Ça≈õ?", answers: ["Wszystkie odpowiedzi", "Kochanie", "Misiu", "Baranek"], correct: 0 },
    { q: "Kiedy by≈Ç nasz pierwszy poca≈Çunek?", answers: ["14 lutego", "1 wrze≈õnia", "28 stycznia", "18 sierpnia"], correct: 3 },
    { q: "Gdzie by≈Ça nasza pierwsza randka?", answers: ["Cliffs Old Head of Kinsale", "Nad jeziorem w G√≥rzynie", "Pizzeria przy stacji", "Zoo we Wroc≈Çawiu"], correct: 0 },
    { q: "W jakƒÖ grƒô ciƒÖgle grali≈õmy razem?", answers: ["Among Us", "Ludo", "FIFA", "Minecraft"], correct: 1 },
    { q: "Co siƒô sta≈Ço gdy szli≈õmy na pizzƒô?", answers: ["Zamknƒôli pizzeriƒô", "Jedli≈õmy jƒÖ na ≈Çaweczce", "Zgubili≈õmy siƒô", "Spotkali≈õmy znajomych"], correct: 1 },
    { q: "Jaki drink pi≈Ça≈õ u mojej mamy?", answers: ["Aperol", "Prosecco", "Malibu ananasowe", "Mojito"], correct: 2 },
    { q: "Co siƒô sta≈Ço z Twoim drinkiem?", answers: ["Przypadkowo Ci go wyla≈Çem", "Zostawi≈Ça≈õ go", "Wypi≈Çam go szybko", "Nic siƒô nie sta≈Ço"], correct: 0 },
    { q: "Jakie lody kupili≈õmy razem?", answers: ["Waniliowe", "Truskawkowe", "Z nutelli", "Czekoladowe"], correct: 2 },
    { q: "Gdzie byli≈õmy na Twoich urodzinach?", answers: ["We Wroc≈Çawiu w zoo", "Nad jeziorem", "W kinie", "W restauracji"], correct: 0 },
    { q: "Co by≈Ço nie tak z hotelem w Poznaniu?", answers: ["Za daleko", "Zimno by≈Ço", "Kamie≈Ñ na kranach i w≈Çosy w ≈Çazience", "Za drogi"], correct: 2 },
    { q: "Dlaczego nazywa≈Ça≈õ mnie barankiem?", answers: ["Bo lubi≈Çem owce", "Bo moje w≈Çosy puszy≈Çy siƒô na deszczu", "Bo by≈Çem uparty", "Bo du≈ºo jad≈Çem"], correct: 1 },
    { q: "Gdzie usiedli≈õmy gdy przylecia≈Çem do Ciebie?", answers: ["Na lotnisku", "W kawiarni", "Nad jeziorkiem w G√≥rzynie", "W parku"], correct: 2 },
    { q: "Jak nazwa≈Ça≈õ mnie 28 stycznia?", answers: ["Moim szczƒô≈õciem", "MojƒÖ mi≈Ço≈õciƒÖ", "Moim wszystkim", "Moim ≈õwiatem"], correct: 0 },
    { q: "Co robili≈õmy podczas nocnych rozm√≥w?", answers: ["Pisali≈õmy wiadomo≈õci", "Zasypiali≈õmy razem", "Grali≈õmy", "OglƒÖdali≈õmy filmy"], correct: 1 }
  ];

  // Password check
  const entered = prompt("Podaj has≈Ço administracyjne:");
  if (entered !== ADMIN_PASSWORD) {
    alert("Nieprawid≈Çowe has≈Ço.");
    window.close();
  }

  // Load points
  let total = parseInt(localStorage.getItem("quizTotalPoints") || "0");
  document.getElementById("adminTotal").textContent = total;

  function updateTotal() {
    localStorage.setItem("quizTotalPoints", total);
    document.getElementById("adminTotal").textContent = total;
  }

  window.changePoints = function() {
    const val = parseInt(document.getElementById("pointsInput").value);
    if (isNaN(val)) return alert("Wpisz poprawnƒÖ liczbƒô.");
    total += val;
    updateTotal();
    document.getElementById("pointsInput").value = "";
  };

  window.setPoints = function(value) {
    if (!confirm(`Ustawiƒá punkty na dok≈Çadnie ${value}?`)) return;
    total = value;
    updateTotal();
  };

  // NEW: Load & display her Would You Rather choices
  function loadWyrChoices() {
    const choices = JSON.parse(localStorage.getItem('wyrChoices') || '[]');
    const listEl = document.getElementById('choicesList');

    if (choices.length === 0) {
      listEl.innerHTML = '<p style="color:#aaa; font-style:italic;">Jeszcze nie ma ≈ºadnych wybor√≥w.</p>';
      return;
    }

    let html = '';
    choices.forEach(c => {
      html += `
        <div class="choice">
          <strong>${c.date} ‚Äì ${c.timestamp}</strong><br>
          <em>${c.question.replace(/\n/g, '<br>')}</em><br>
          <strong>Wybra≈Ça: ${c.chosen}</strong>
        </div>
      `;
    });
    listEl.innerHTML = html;
  }

  // Clear history
  window.clearWyrChoices = function() {
    if (!confirm("Na pewno chcesz wyczy≈õciƒá ca≈ÇƒÖ historiƒô jej wybor√≥w?")) return;
    localStorage.removeItem('wyrChoices');
    loadWyrChoices();
  };

  // Load choices on page open
  loadWyrChoices();
  // ================= QUIZ QUESTIONS VIEW =================



function loadQuizQuestions() {
  const container = document.getElementById("quizQuestionsList");
  const custom = JSON.parse(localStorage.getItem("customQuizQuestions") || "[]");

  let html = "";
  let counter = 1;

  function questionBlock(q, type, deleteIndex = null) {
    const color = type === "built" ? "#ff4081" : "#4caf50";
    const label = type === "built" ? "Pytanie wbudowane" : "Dodane przez niƒÖ";

    return `
      <div class="choice" style="border-left-color:${color}">
        <div onclick="toggleAnswers(this)" style="cursor:pointer;">
          <strong>${counter++}. ${q.q}</strong>
          <div style="font-size:0.85rem;color:${color};margin-top:4px;">
            ${label} ‚Ä¢ kliknij aby zobaczyƒá odpowiedzi
          </div>
        </div>

        <div class="answers" style="display:none;margin-top:12px;">
          ${q.answers.map((a,i)=>
            `<div>${i===q.correct?`<b>${a}</b>`:a}</div>`
          ).join("")}

          ${
            deleteIndex !== null ? `
            <button onclick="deleteCustomQuestion(${deleteIndex})"
              style="margin-top:10px;background:#f44336;color:white;
                     border:none;padding:6px 12px;border-radius:6px;cursor:pointer;">
              Usu≈Ñ pytanie
            </button>` : ""
          }
        </div>
      </div>
    `;
  }

  ALL_QUESTIONS.forEach(q => {
    html += questionBlock(q, "built");
  });

  custom.forEach((q,i) => {
    html += questionBlock(q, "custom", i);
  });

  container.innerHTML = html || "<p style='color:#aaa'>Brak pyta≈Ñ.</p>";
}


// Load on open
loadQuizQuestions();

window.deleteCustomQuestion = function(index) {
  if (!confirm("UsunƒÖƒá to pytanie?")) return;

  const custom = JSON.parse(localStorage.getItem("customQuizQuestions") || "[]");
  custom.splice(index, 1);
  localStorage.setItem("customQuizQuestions", JSON.stringify(custom));

  loadQuizQuestions();
};

// üîÑ Auto-refresh gdy ona doda pytanie
window.addEventListener("storage", (e) => {
  if (e.key === "customQuizQuestions") {
    loadQuizQuestions();
  }
});

window.toggleAnswers = function(el) {
  const answers = el.nextElementSibling;
  answers.style.display =
    answers.style.display === "none" ? "block" : "none";
};


</script>

</body>
</html>